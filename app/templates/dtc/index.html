{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}UAV_HiRAP{% endblock %}

{% block head %}
{{ super() }}
<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
{% endblock%}

{% block page_content %}
{% if current_user.edit_required %}
<div class="page-header">
    <h1>
    <p>Your profile information is not completely, please reedit it again.</p>
    <p>we will recheck it soon.</p>
    </h1>
</div>
{% else %}
<div class="page-header">
    <h1>
    Here is your projects page, You could:
    </h1>
</div>
<div>
	<h2>Add a new project:</h2>
    <form class="form" method="post" enctype="multipart/form-data" action="{{ url_for('dtc.decision_tree_submit', username=current_user.username) }}">
    <table width="100%" border="0">
      <tr>
        <td colspan="3">
        {{ form.hidden_tag() }}
        {{ wtf.form_field(form.project_name) }}</td>
      </tr>
      <tr>
        <td width="33%" rowspan="2" align="center">
        {{ wtf.form_field(form.origin_pic_dir) }}        </td>
        <td width="33%" align="center">{{ wtf.form_field(form.fore_trainingdata_dir) }} </td>
        <td width="33%" align="center">{{ wtf.form_field(form.back_trainingdata_dir) }} </td>
      </tr>
      <tr>
        <td colspan="2" align="center"><font color="red">Note: if training pictures do not have an alpha layer, the black/white background will be counted as training data</font></td>
      </tr>
      <tr>
        <td colspan="3" align="center"><hr /></td>
      </tr>
      <tr>
		<td align="center">
    		<font color="gray">Example:[Otindag Sandy land.tif]</font>
    		<p><img src="{{ url_for('static', filename="ExamplePictures/preview-Classify.jpg") }}" width="80%"/></p>
    	</td>
    	<td align="center">
    		<font color="gray">Example:[Tree training picture.png]</font>
    		<p><img src="{{ url_for('static', filename="ExamplePictures/preview-Tree.png") }}" width="80%"/></p>
    	</td>
    	<td align="center">
    		<font color="gray">Example:[Sand training picture.png]</font>
    		<p><img src="{{ url_for('static', filename="ExamplePictures/preview-Sand.png") }}" width="80%"/></p></td>
  		</tr>
      </tr>
    </table>
    {{ wtf.form_field(form.comments) }}
    {{ wtf.form_field(form.submit, id="smb") }}
    </form>
</div>
<hr />
<!-- div class="progress">
    <div id="progressBar", class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: 2%;">
    	0%
    </div>
</div>
<script type="text/javascript">
$(function(){  
	
	$('#smb').on('click', function(event) {
			
		event.preventDefault();
			
		var formData = new FormData($('form')[0]);
			
		$.ajax({
			xhr: function(){
				var xhr = new window.XMLHttpRequest();
				
				xhr.upload.addEventListener('progress', function(e) {
						
					if (e.lengthComputable) {

						console.log('Bytes loaded: ' + e.loaded);
						console.log('total Size:' + e.total);
						console.log('Percentage Uploaded: ' + (e.loaded / e.total))

						var percent = Math.round((e.loaded / e.total) * 100);

						$('#progressBar').attr('aria-valuenow', percent).css('width', percent + '%').text(percent + '%')

					}
				
				});
				
				return xhr;
			},
			type: 'POST',
			data: formData,
			cache: false,
			processData:false,
			contentType:false
		
		});
		
	});
	
});
</script-->
<div>
	<h2>Or view/edit your former projects:</h2>
</div>
<!-- Use style.css, the example template is for "Post" database. But in this project, we replace "Post" to "DTC_Project", so it is the reason why the following codes' class== post* -->
<ul class="posts">
	{% for dtc_project in dtc_projects %}
    <li class="post">
    	<div class="profile-thumbnail">
				<img class="img-rounded profile-thumbnail" src="{{ url_for('static', filename='UserData/'+current_user.email+'/'+dtc_project.id|string+dtc_project.icon|string) }} ">
		</div>
        <div class="post-content">
        	<div class="post-date">{{ moment(dtc_project.timestamp).fromNow() }}</div>
        	<div class="post-author">
        		<a href="{{ url_for('dtc.inproject', username=current_user.username, project_id=dtc_project.id)}}">
            		{{ dtc_project.project_name }}
            	</a>
        	</div>
        	<div class="post-body">
            	{{ dtc_project.comments }}
            </div>
            <div class="post-foot">
				<a href="{{ url_for('dtc.edit', username=current_user.username, project_id=dtc_project.id) }}">
					<span class="label label-primary">Edit</span>
				</a>
                <a href="javascript:if(confirm('Are you sure to delete this object?'))location='{{ url_for('dtc.delete', username=current_user.username, project_id=dtc_project.id) }}'">
                    <span class="label label-default">Delete</span>
                </a>
            </div>
        </div>
    </li>
    {% endfor %}
</ul>
{% endif %}
{% endblock %}

